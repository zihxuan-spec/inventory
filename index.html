<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management</title>
    <style>
        /* --- Professional Enterprise Style (Fiori-inspired) --- */
        :root {
            --theme-primary: #354a5f; /* Professional Shell Blue */
            --theme-bg: #edf0f4;      /* Enterprise Gray Background */
            --theme-surface: #ffffff;
            --theme-text: #32363a;
            --theme-label: #6a6d70;
            --theme-border: #d9d9d9;
            --theme-highlight: #0a6ed1; /* Focus Blue */
            --theme-success: #107e3e;
            --theme-critical: #bb0000;
            --theme-warning: #e9730c;
            --font-family: "Segoe UI", "Roboto", "Helvetica Neue", sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-family);
            background-color: var(--theme-bg);
            color: var(--theme-text);
            font-size: 14px;
        }

        /* --- Shell Bar (Top Nav) --- */
        .shell-bar {
            background-color: var(--theme-primary);
            height: 48px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
        .shell-title {
            color: white;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.5px;
        }
        .lang-switch {
            color: rgba(255,255,255,0.8);
            cursor: pointer;
            font-size: 13px;
            border: 1px solid rgba(255,255,255,0.4);
            padding: 4px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        .lang-switch:hover {
            color: white;
            border-color: white;
            background: rgba(255,255,255,0.1);
        }

        /* --- Page Layout --- */
        .page-header {
            background-color: var(--theme-surface);
            padding: 16px 32px;
            border-bottom: 1px solid var(--theme-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .page-title {
            font-size: 20px;
            font-weight: normal;
            color: var(--theme-text);
        }
        .subtitle {
            font-size: 12px;
            color: var(--theme-label);
            margin-top: 4px;
        }

        .content-area {
            padding: 20px 32px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- Controls & Inputs --- */
        .toolbar {
            background: transparent;
            padding: 10px 0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        .std-input {
            padding: 8px 12px;
            border: 1px solid #89919a;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            width: 250px;
            transition: border-color 0.2s;
        }
        .std-input:focus {
            outline: none;
            border-color: var(--theme-highlight);
            box-shadow: 0 0 0 2px rgba(10, 110, 209, 0.1);
        }

        /* --- Data Table --- */
        .table-container {
            background: var(--theme-surface);
            border: 1px solid var(--theme-border);
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
        }
        thead {
            background-color: #f7f7f7;
            border-bottom: 1px solid var(--theme-border);
        }
        th {
            padding: 12px 16px;
            font-weight: 600;
            color: var(--theme-label);
            font-size: 12px;
            text-transform: uppercase;
        }
        td {
            padding: 12px 16px;
            border-bottom: 1px solid #eeeeee;
            vertical-align: middle;
        }
        tr:hover {
            background-color: #f5f7fa;
            cursor: pointer;
        }

        /* Status Indicators */
        .status-dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        .status-ok { background-color: var(--theme-success); }
        .status-low { background-color: var(--theme-warning); }
        .status-crit { background-color: var(--theme-critical); }

        /* --- Modal (Dialog) --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .std-dialog {
            background: white;
            width: 400px;
            border-radius: 6px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.2s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .dialog-header {
            background: #f4f6f8;
            padding: 12px 20px;
            border-bottom: 1px solid var(--theme-border);
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            color: var(--theme-text);
        }
        .dialog-content {
            padding: 24px 20px;
        }
        .dialog-footer {
            padding: 12px 20px;
            border-top: 1px solid var(--theme-border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            background: #fcfcfc;
        }

        /* --- Buttons --- */
        .std-btn {
            border: 1px solid var(--theme-highlight);
            color: var(--theme-highlight);
            background: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            min-width: 80px;
        }
        .std-btn:hover { background: #f0f8ff; }
        
        .std-btn-primary {
            background: var(--theme-highlight);
            color: white;
        }
        .std-btn-primary:hover { background: #0854a0; }

        .std-btn-danger {
            border-color: var(--theme-critical);
            color: var(--theme-critical);
        }
        .std-btn-danger:hover { background: #fff0f0; }

        .std-btn-transparent {
            border: 1px solid transparent;
            color: var(--theme-text);
        }
        .std-btn-transparent:hover { background: #eaeaea; }

        .qty-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .qty-input {
            width: 80px;
            text-align: right;
            font-weight: bold;
        }

        /* Toast Message */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--theme-text);
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 13px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>

<div class="shell-bar">
    <div class="shell-title" data-i18n="app_title">Inventory Manager</div>
    <div class="lang-switch" onclick="toggleLanguage()">EN / 繁中</div>
</div>

<div class="page-header">
    <div>
        <div class="page-title" data-i18n="overview_title">Stock Overview</div>
        <div class="subtitle"><span data-i18n="location">Location</span>: Arizona Warehouse</div>
    </div>
    <div>
        <button class="std-btn std-btn-transparent" onclick="renderTable()" data-i18n="btn_refresh">Refresh</button>
    </div>
</div>

<div class="content-area">
    <div class="toolbar">
        <input type="text" id="searchInput" class="std-input" placeholder="Search..." onkeyup="renderTable()">
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th style="width: 50px;"></th>
                    <th style="width: 120px;" data-i18n="col_id">ID</th>
                    <th data-i18n="col_desc">Description</th>
                    <th style="text-align: right;" data-i18n="col_stock">Stock Level</th>
                    <th style="width: 80px;" data-i18n="col_unit">Unit</th>
                    <th style="width: 120px; text-align:center;" data-i18n="col_action">Action</th>
                </tr>
            </thead>
            <tbody id="inventoryBody">
                </tbody>
        </table>
    </div>
</div>

<div id="actionModal" class="modal-overlay">
    <div class="std-dialog">
        <div class="dialog-header">
            <span id="modalTitle" data-i18n="modal_title">Goods Movement</span>
            <span style="cursor:pointer;" onclick="closeModal()">✕</span>
        </div>
        <div class="dialog-content">
            <div style="margin-bottom: 5px; color: var(--theme-label); font-size: 12px;" data-i18n="modal_material">Material</div>
            <div id="modalItemName" style="font-weight: 600; font-size: 16px; margin-bottom: 24px;">Item Name</div>

            <div style="margin-bottom: 5px; color: var(--theme-label); font-size: 12px;" data-i18n="modal_qty">Quantity</div>
            <div class="qty-control">
                <input type="number" id="qtyInput" class="std-input qty-input" value="1" min="1">
                <span id="modalUnit" style="font-weight:600; color: var(--theme-label);">PC</span>
            </div>
        </div>
        <div class="dialog-footer">
            <button class="std-btn std-btn-transparent" onclick="closeModal()" data-i18n="btn_cancel">Cancel</button>
            <button class="std-btn std-btn-danger" onclick="confirmAction(-1)" data-i18n="btn_issue">Issue (-)</button>
            <button class="std-btn std-btn-primary" onclick="confirmAction(1)" data-i18n="btn_receive">Receive (+)</button>
        </div>
    </div>
</div>

<div id="toast" class="toast">Data Saved</div>

<script>
    // --- 1. Localization (i18n) Configuration ---
    const translations = {
        en: {
            app_title: "Inventory Manager",
            overview_title: "Stock Overview",
            location: "Location",
            btn_refresh: "Refresh",
            col_id: "ID",
            col_desc: "Description",
            col_stock: "Stock Level",
            col_unit: "Unit",
            col_action: "Action",
            manage: "Manage",
            modal_title: "Goods Movement",
            modal_material: "Material",
            modal_qty: "Quantity",
            btn_cancel: "Cancel",
            btn_issue: "Issue (-)",
            btn_receive: "Receive (+)",
            msg_stock_deficit: "Error: Insufficient Stock",
            msg_success_in: "Goods Receipt Posted",
            msg_success_out: "Goods Issue Posted",
            placeholder_search: "Search ID or Name..."
        },
        zh: {
            app_title: "庫存管理系統",
            overview_title: "庫存總覽",
            location: "倉庫位置",
            btn_refresh: "重新整理",
            col_id: "料號",
            col_desc: "備品名稱",
            col_stock: "現有庫存",
            col_unit: "單位",
            col_action: "操作",
            manage: "管理",
            modal_title: "貨物移動",
            modal_material: "物料名稱",
            modal_qty: "異動數量",
            btn_cancel: "取消",
            btn_issue: "領料 (-)",
            btn_receive: "入庫 (+)",
            msg_stock_deficit: "錯誤：庫存不足",
            msg_success_in: "入庫過帳成功",
            msg_success_out: "領用過帳成功",
            placeholder_search: "搜尋料號或名稱..."
        }
    };

    let currentLang = 'en'; // Default Language

    function toggleLanguage() {
        currentLang = currentLang === 'en' ? 'zh' : 'en';
        updateTexts();
    }

    function updateTexts() {
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[currentLang][key]) {
                el.innerText = translations[currentLang][key];
            }
        });

        // Special case for input placeholder
        const searchInput = document.getElementById('searchInput');
        searchInput.placeholder = translations[currentLang]['placeholder_search'];

        // Re-render table to update dynamic "Manage" button text
        renderTable();
    }

    // --- 2. Mock Data ---
    let inventoryData = [
        { id: "M-1001", name: "AA Battery (3號電池)", stock: 15, unit: "PC", minStock: 10 },
        { id: "P-2044", name: "A4 Paper (印表機紙)", stock: 3, unit: "BAG", minStock: 5 },
        { id: "S-3001", name: "Ballpoint Pen Black (原子筆)", stock: 54, unit: "PC", minStock: 10 },
        { id: "H-5002", name: "Tissue Paper (衛生紙)", stock: 2, unit: "BAG", minStock: 5 },
        { id: "L-9001", name: "LEGO Brush (清潔刷)", stock: 1, unit: "PC", minStock: 1 }
    ];

    let currentSelectedIndex = -1;

    // --- 3. UI Logic ---
    function renderTable() {
        const tbody = document.getElementById('inventoryBody');
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        tbody.innerHTML = '';

        const manageText = translations[currentLang]['manage'];

        inventoryData.forEach((item, index) => {
            if (item.name.toLowerCase().includes(searchTerm) || item.id.toLowerCase().includes(searchTerm)) {
                
                let statusClass = 'status-ok';
                if (item.stock <= 0) statusClass = 'status-crit';
                else if (item.stock < item.minStock) statusClass = 'status-low';

                const tr = document.createElement('tr');
                tr.onclick = () => openModal(index);
                
                tr.innerHTML = `
                    <td><span class="status-dot ${statusClass}"></span></td>
                    <td style="font-family: monospace; font-size: 13px;">${item.id}</td>
                    <td style="font-weight: 500;">${item.name}</td>
                    <td style="text-align: right; font-weight: bold;">${item.stock}</td>
                    <td style="color: #666;">${item.unit}</td>
                    <td style="text-align: center;"><span style="font-size:12px; color: var(--theme-highlight); font-weight:600;">${manageText}</span></td>
                `;
                tbody.appendChild(tr);
            }
        });
    }

    function openModal(index) {
        currentSelectedIndex = index;
        const item = inventoryData[index];
        document.getElementById('modalItemName').innerText = `${item.id} - ${item.name}`;
        document.getElementById('modalUnit').innerText = item.unit;
        document.getElementById('qtyInput').value = 1;
        document.getElementById('actionModal').style.display = 'flex';
        // Focus on input for quick typing
        setTimeout(() => document.getElementById('qtyInput').focus(), 100);
    }

    function closeModal() {
        document.getElementById('actionModal').style.display = 'none';
    }

    function confirmAction(direction) {
        const qty = parseInt(document.getElementById('qtyInput').value);
        if (qty <= 0 || isNaN(qty)) return;

        const item = inventoryData[currentSelectedIndex];
        
        // Stock check
        if (direction === -1 && item.stock < qty) {
            showToast(translations[currentLang]['msg_stock_deficit'], true);
            return;
        }

        item.stock += (qty * direction);
        
        // --- API Call Placeholder ---
        console.log(`Updated ${item.id}: New Stock = ${item.stock}`);

        closeModal();
        renderTable();
        
        const msg = direction === 1 ? translations[currentLang]['msg_success_in'] : translations[currentLang]['msg_success_out'];
        showToast(msg);
    }

    function showToast(message, isError = false) {
        const toast = document.getElementById('toast');
        toast.innerText = message;
        toast.style.opacity = 1;
        toast.style.backgroundColor = isError ? var(--theme-critical) : var(--theme-text); // fallback managed in CSS
        if(isError) toast.style.backgroundColor = "#bb0000";
        else toast.style.backgroundColor = "#32363a";
        
        setTimeout(() => {
            toast.style.opacity = 0;
        }, 2000);
    }

    // Close modal when clicking outside
    document.getElementById('actionModal').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
    });

    // Init Language and Table
    updateTexts(); 
</script>

</body>
</html>
